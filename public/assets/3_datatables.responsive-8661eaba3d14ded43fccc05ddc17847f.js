"use strict";function ResponsiveDatatablesHelper(e,t){this.tableElement="string"==typeof e?$(e):e,this.columnIndexes=[],this.columnsShownIndexes=[],this.columnsHiddenIndexes=[],this.expandColumn=void 0,this.breakpoints={},this.expandIconTemplate='<span class="responsiveExpander"></span>',this.rowTemplate='<tr class="row-detail"><td><ul><!--column item--></ul></td></tr>',this.rowLiTemplate='<li><span class="columnTitle"><!--column title--></span>: <!--column value--></li>',this.disabled=!1,this.skipNextWindowsWidthChange=!1,this.init(t)}ResponsiveDatatablesHelper.prototype.init=function(e){var t=[];_.each(e,function(e,s){t.push({name:s,upperLimit:e,columnsToHide:[]})}),t=_.sortBy(t,"upperLimit");var s=void 0;_.each(t,function(e){e.lowerLimit=s,s=e.upperLimit}),t.push({name:"default",lowerLimit:s,upperLimit:void 0,columnsToHide:[]});for(var n=0;n<t.length;n++)this.breakpoints[t[n].name]=t[n];for(var i=this.tableElement.fnSettings().aoColumns,n=0;n<i.length;n++)i[n].bVisible&&this.columnIndexes.push(n);var a=$("thead th",this.tableElement);_.each(a,function(e,t){"expand"===$(e).attr("data-class")&&(this.expandColumn=t);var s=$(e).attr("data-hide");if(void 0!==s){var n=s.split(/,\s*/);_.each(n,function(e){void 0!==this.breakpoints[e]&&this.breakpoints[e].columnsToHide.push(this.columnIndexes[t])},this)}},this);var o=this;$(window).bind("resize",function(){o.respond()})},ResponsiveDatatablesHelper.prototype.respond=function(){if(!this.disabled){var e=$(window).width(),t=0,s=[];_.each(this.breakpoints,function(t){(!t.lowerLimit||e>t.lowerLimit)&&(!t.upperLimit||e<=t.upperLimit)&&(s=t.columnsToHide)},this);var n=!1;if(!this.skipNextWindowsWidthChange)if(this.columnsHiddenIndexes.length!==s.length)n=!0;else{var i=_.difference(this.columnsHiddenIndexes,s).length,a=_.difference(s,this.columnsHiddenIndexes).length;n=i+a>0}if(n&&(this.skipNextWindowsWidthChange=!0,this.columnsHiddenIndexes=s,this.columnsShownIndexes=_.difference(this.columnIndexes,this.columnsHiddenIndexes),this.showHideColumns(),t=this.columnsHiddenIndexes.length,this.skipNextWindowsWidthChange=!1),this.columnsHiddenIndexes.length){this.tableElement.addClass("has-columns-hidden");var o=this;$("tr.detail-show",this.tableElement).each(function(e,t){var s=$(t);0===s.next(".row-detail").length&&ResponsiveDatatablesHelper.prototype.showRowDetail(o,s)})}else this.tableElement.removeClass("has-columns-hidden"),$("tr.row-detail").remove()}},ResponsiveDatatablesHelper.prototype.showHideColumns=function(){for(var e=0,t=this.columnsShownIndexes.length;t>e;e++)this.tableElement.fnSetColumnVis(this.columnsShownIndexes[e],!0,!1);for(var e=0,t=this.columnsHiddenIndexes.length;t>e;e++)this.tableElement.fnSetColumnVis(this.columnsHiddenIndexes[e],!1,!1);var s=this;$("tr.row-detail").remove(),this.tableElement.hasClass("has-columns-hidden")&&$("tr.detail-show",this.tableElement).each(function(e,t){ResponsiveDatatablesHelper.prototype.showRowDetail(s,$(t))})},ResponsiveDatatablesHelper.prototype.createExpandIcon=function(e){if(!this.disabled){var t=$("td",e);if(void 0!==this.expandColumn&&this.expandColumn<t.length){var s=$(t[this.expandColumn]);0==$("span.responsiveExpander",s).length&&(s.prepend(this.expandIconTemplate),s.on("click","span.responsiveExpander",{responsiveDatatablesHelperInstance:this},this.showRowDetailEventHandler))}}},ResponsiveDatatablesHelper.prototype.showRowDetailEventHandler=function(e){if(!this.disabled){var t=$(this).closest("tr");t.hasClass("detail-show")?ResponsiveDatatablesHelper.prototype.hideRowDetail(e.data.responsiveDatatablesHelperInstance,t):ResponsiveDatatablesHelper.prototype.showRowDetail(e.data.responsiveDatatablesHelperInstance,t),t.toggleClass("detail-show"),e.stopPropagation()}},ResponsiveDatatablesHelper.prototype.showRowDetail=function(e,t){var s=e.tableElement,n=s.fnSettings().aoColumns,i=$(e.rowTemplate),a=$("ul",i);_.each(e.columnsHiddenIndexes,function(i){var o=$(e.rowLiTemplate);$(".columnTitle",o).html(n[i].sTitle),o.append(s.fnGetData(t[0],i)),a.append(o)});var o=e.columnIndexes.length-e.columnsHiddenIndexes.length;$("td",i).attr("colspan",o),t.after(i)},ResponsiveDatatablesHelper.prototype.hideRowDetail=function(e,t){t.next(".row-detail").remove()},ResponsiveDatatablesHelper.prototype.disable=function(e){this.disabled=void 0===e||!0,this.disabled&&($("tbody tr.row-detail",this.tableElement).remove(),$("tbody tr",this.tableElement).removeClass("detail-show"),$("tbody tr span.responsiveExpander",this.tableElement).remove(),this.columnsHiddenIndexes=[],this.columnsShownIndexes=this.columnIndexes,this.showHideColumns(),this.tableElement.removeClass("has-columns-hidden"),this.tableElement.off("click","span.responsiveExpander",this.showRowDetailEventHandler))};